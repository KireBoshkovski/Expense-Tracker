<!-- expense-add.component.html -->
<navbar></navbar>

<div class="container">
    <form
        [formGroup]="expenseForm"
        (ngSubmit)="onSave(expenseForm.value)"
        class="expense-form"
    >
        <h2>Add New Expense</h2>

        <div class="form-field">
            <label for="title">Title:</label>
            <input
                id="title"
                type="text"
                formControlName="title"
                required
                placeholder="Enter expense title"
                autocomplete="off"
            />
            @if (expenseForm.get('title')?.invalid &&
            expenseForm.get('title')?.touched) {
            <div class="error">Title is required</div>
            }
        </div>

        <div class="form-field">
            <label for="amount">Amount:</label>
            <input
                id="amount"
                type="number"
                formControlName="amount"
                required
                min="0"
                step="0.01"
                placeholder="0.00"
                autocomplete="off"
            />
            @if (expenseForm.get('amount')?.invalid &&
            expenseForm.get('amount')?.touched) {
            <div class="error">
                @if (expenseForm.get('amount')?.errors?.['required']) { Amount
                is required } @if (expenseForm.get('amount')?.errors?.['min']) {
                Amount must be greater than or equal to 0 }
            </div>
            }
        </div>

        <div class="form-field">
            <label for="category">Category:</label>
            <select id="category" formControlName="category" required>
                <option value="" disabled>Select a category</option>
                <option value="Food & Dining">Food & Dining</option>
                <option value="Transportation">Transportation</option>
                <option value="Entertainment">Entertainment</option>
                <option value="Utilities">Utilities</option>
                <option value="Healthcare">Healthcare</option>
                <option value="Shopping">Shopping</option>
                <option value="Travel">Travel</option>
                <option value="Education">Education</option>
                <option value="Personal Care">Personal Care</option>
                <option value="Miscellaneous">Miscellaneous</option>
            </select>
            @if (expenseForm.get('category')?.invalid &&
            expenseForm.get('category')?.touched) {
            <div class="error">Category is required</div>
            }
        </div>

        <div class="form-field">
            <label for="date">Date:</label>
            <input
                id="date"
                type="date"
                formControlName="date"
                required
                [max]="getCurrentDate()"
            />
            @if (expenseForm.get('date')?.invalid &&
            expenseForm.get('date')?.touched) {
            <div class="error">Date is required</div>
            }
        </div>

        <div class="form-actions">
            <button
                type="submit"
                [disabled]="!expenseForm.valid || isSubmitting"
                class="btn-primary"
            >
                @if (isSubmitting) {
                <span class="spinner"></span>
                Adding... } @else { Add Expense }
            </button>
            <button type="button" routerLink="/expenses" class="btn-secondary">
                Cancel
            </button>
        </div>
    </form>
</div>
